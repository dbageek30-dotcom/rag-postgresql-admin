

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Environment Configuration Settings &mdash; Patroni 4.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="_static/github_style.css?v=1093691d" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=977c162b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=42d1b3bd"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Patroni REST API" href="rest_api.html" />
    <link rel="prev" title="YAML Configuration Settings" href="yaml_configuration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Patroni
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="patroni_configuration.html">Patroni configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dynamic_configuration.html">Dynamic Configuration Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="yaml_configuration.html">YAML Configuration Settings</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Environment Configuration Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#global-universal">Global/Universal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#log">Log</a></li>
<li class="toctree-l3"><a class="reference internal" href="#citus">Citus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#consul">Consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="#etcd">Etcd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#etcdv3">Etcdv3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#zookeeper">ZooKeeper</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exhibitor">Exhibitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kubernetes">Kubernetes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#raft-deprecated">Raft (deprecated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rest-api">REST API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ctl">CTL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patroni_configuration.html#important-rules">Important rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="patroni_configuration.html#configuration-generation-and-validation">Configuration generation and validation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rest_api.html">Patroni REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="patronictl.html">patronictl</a></li>
<li class="toctree-l1"><a class="reference internal" href="replica_bootstrap.html">Replica imaging and bootstrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="replication_modes.html">Replication modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="standby_cluster.html">Standby cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="watchdog.html">Watchdog support</a></li>
<li class="toctree-l1"><a class="reference internal" href="pause.html">Pause/Resume mode for the cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="dcs_failsafe_mode.html">DCS Failsafe Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Using Patroni with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="citus.html">Citus support</a></li>
<li class="toctree-l1"><a class="reference internal" href="existing_data.html">Convert a Standalone to a Patroni Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="existing_data.html#major-upgrade-of-postgresql-version">Major Upgrade of PostgreSQL Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools_integration.html">Integration with other tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="ha_multi_dc.html">HA multi datacenter</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Patroni</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="patroni_configuration.html">Patroni configuration</a></li>
      <li class="breadcrumb-item active">Environment Configuration Settings</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/patroni/patroni/blob/master/docs/ENVIRONMENT.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="environment-configuration-settings">
<span id="environment"></span><h1>Environment Configuration Settings<a class="headerlink" href="#environment-configuration-settings" title="Link to this heading"></a></h1>
<p>It is possible to override some of the configuration parameters defined in the Patroni configuration file using the system environment variables. This document lists all environment variables handled by Patroni. The values set via those variables always take precedence over the ones set in the Patroni configuration file.</p>
<section id="global-universal">
<h2>Global/Universal<a class="headerlink" href="#global-universal" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_CONFIGURATION</strong>: it is possible to set the entire configuration for the Patroni via <code class="docutils literal notranslate"><span class="pre">PATRONI_CONFIGURATION</span></code> environment variable. In this case any other environment variables will not be considered!</p></li>
<li><p><strong>PATRONI_NAME</strong>: name of the node where the current instance of Patroni is running. Must be unique for the cluster.</p></li>
<li><p><strong>PATRONI_NAMESPACE</strong>: path within the configuration store where Patroni will keep information about the cluster. Default value: “/service”</p></li>
<li><p><strong>PATRONI_SCOPE</strong>: cluster name</p></li>
</ul>
</section>
<section id="log">
<h2>Log<a class="headerlink" href="#log" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_LOG_TYPE</strong>: sets the format of logs. Can be either <strong>plain</strong> or <strong>json</strong>. To use <strong>json</strong> format, you must have the <a class="reference internal" href="installation.html#extras"><span class="std std-ref">jsonlogger</span></a> installed. The default value is <strong>plain</strong>.</p></li>
<li><p><strong>PATRONI_LOG_LEVEL</strong>: sets the general logging level. Default value is <strong>INFO</strong> (see <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#levels">the docs for Python logging</a>)</p></li>
<li><p><strong>PATRONI_LOG_TRACEBACK_LEVEL</strong>: sets the level where tracebacks will be visible. Default value is <strong>ERROR</strong>. Set it to <strong>DEBUG</strong> if you want to see tracebacks only if you enable <strong>PATRONI_LOG_LEVEL=DEBUG</strong>.</p></li>
<li><p><strong>PATRONI_LOG_FORMAT</strong>: sets the log formatting string. If the log type is <strong>plain</strong>, the log format should be a string.
Refer to <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#logrecord-attributes">the LogRecord attributes</a> for
available attributes. If the log type is <strong>json</strong>, the log format can be a list in addition to a string. Each list
item should correspond to LogRecord attributes. Be cautious that only the field name is required, and the <strong>%(</strong>
and <strong>)</strong> should be omitted. If you wish to print a log field with a different key name, use a dictionary where
the dictionary key is the log field, and the value is the name of the field you want to be printed in the log.
Default value is <strong>%(asctime)s %(levelname)s: %(message)s</strong></p></li>
<li><p><strong>PATRONI_LOG_DATEFORMAT</strong>: sets the datetime formatting string. (see the <a class="reference external" href="https://docs.python.org/3.6/library/logging.html#logging.Formatter.formatTime">formatTime() documentation</a>)</p></li>
<li><p><strong>PATRONI_LOG_STATIC_FIELDS</strong>: add additional fields to the log. This option is only available when the log type is set to <strong>json</strong>. Example <code class="docutils literal notranslate"><span class="pre">PATRONI_LOG_STATIC_FIELDS=&quot;{app:</span> <span class="pre">patroni}&quot;</span></code></p></li>
<li><p><strong>PATRONI_LOG_MAX_QUEUE_SIZE</strong>: Patroni is using two-step logging. Log records are written into the in-memory queue and there is a separate thread which pulls them from the queue and writes to stderr or file. The maximum size of the internal queue is limited by default by <strong>1000</strong> records, which is enough to keep logs for the past 1h20m.</p></li>
<li><p><strong>PATRONI_LOG_DIR</strong>: Directory to write application logs to. The directory must exist and be writable by the user executing Patroni. If you set this env variable, the application will retain 4 25MB logs by default. You can tune those retention values with <cite>PATRONI_LOG_FILE_NUM</cite> and <cite>PATRONI_LOG_FILE_SIZE</cite> (see below).</p></li>
<li><p><strong>PATRONI_LOG_MODE</strong>: Permissions for log files (for example, <code class="docutils literal notranslate"><span class="pre">0644</span></code>). If not specified, permissions will be set based on the current umask value.</p></li>
<li><p><strong>PATRONI_LOG_FILE_NUM</strong>: The number of application logs to retain.</p></li>
<li><p><strong>PATRONI_LOG_FILE_SIZE</strong>: Size of patroni.log file (in bytes) that triggers a log rolling.</p></li>
<li><p><strong>PATRONI_LOG_LOGGERS</strong>: Redefine logging level per python module. Example <code class="docutils literal notranslate"><span class="pre">PATRONI_LOG_LOGGERS=&quot;{patroni.postmaster:</span> <span class="pre">WARNING,</span> <span class="pre">urllib3:</span> <span class="pre">DEBUG}&quot;</span></code></p></li>
<li><p><strong>PATRONI_LOG_DEDUPLICATE_HEARTBEAT_LOGS</strong>: If set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, successive heartbeat logs that are identical shall not be output. Default value is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The time the HA loop executes at can be very valuable information in diagnosing failovers due to resource exhaustion and similar problems. When <code class="docutils literal notranslate"><span class="pre">PATRONI_LOG_DEDUPLICATE_HEARTBEAT_LOGS</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> there will be no log generated for the HA loop execution (unless the leader changes) and hence this potentially useful information will not be available from the logs.</p>
</div>
</section>
<section id="citus">
<h2>Citus<a class="headerlink" href="#citus" title="Link to this heading"></a></h2>
<p>Enables integration Patroni with <a class="reference external" href="https://docs.citusdata.com">Citus</a>. If configured, Patroni will take care of registering Citus worker nodes on the coordinator. You can find more information about Citus support <a class="reference internal" href="citus.html#citus"><span class="std std-ref">here</span></a>.</p>
<ul class="simple">
<li><p><strong>PATRONI_CITUS_GROUP</strong>: the Citus group id, integer. Use <code class="docutils literal notranslate"><span class="pre">0</span></code> for coordinator and <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, etc… for workers</p></li>
<li><p><strong>PATRONI_CITUS_DATABASE</strong>: the database where <code class="docutils literal notranslate"><span class="pre">citus</span></code> extension should be created. Must be the same on the coordinator and all workers. Currently only one database is supported.</p></li>
</ul>
</section>
<section id="consul">
<h2>Consul<a class="headerlink" href="#consul" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_CONSUL_HOST</strong>: the host:port for the Consul local agent.</p></li>
<li><p><strong>PATRONI_CONSUL_URL</strong>: url for the Consul local agent, in format: http(s)://host:port</p></li>
<li><p><strong>PATRONI_CONSUL_PORT</strong>: (optional) Consul port</p></li>
<li><p><strong>PATRONI_CONSUL_SCHEME</strong>: (optional) <strong>http</strong> or <strong>https</strong>, defaults to <strong>http</strong></p></li>
<li><p><strong>PATRONI_CONSUL_TOKEN</strong>: (optional) ACL token</p></li>
<li><p><strong>PATRONI_CONSUL_VERIFY</strong>: (optional) whether to verify the SSL certificate for HTTPS requests</p></li>
<li><p><strong>PATRONI_CONSUL_CACERT</strong>: (optional) The ca certificate. If present it will enable validation.</p></li>
<li><p><strong>PATRONI_CONSUL_CERT</strong>: (optional) File with the client certificate</p></li>
<li><p><strong>PATRONI_CONSUL_KEY</strong>: (optional) File with the client key. Can be empty if the key is part of certificate.</p></li>
<li><p><strong>PATRONI_CONSUL_DC</strong>: (optional) Datacenter to communicate with. By default the datacenter of the host is used.</p></li>
<li><p><strong>PATRONI_CONSUL_CONSISTENCY</strong>: (optional) Select consul consistency mode. Possible values are <code class="docutils literal notranslate"><span class="pre">default</span></code>, <code class="docutils literal notranslate"><span class="pre">consistent</span></code>, or <code class="docutils literal notranslate"><span class="pre">stale</span></code> (more details in <a class="reference external" href="https://www.consul.io/api/features/consistency.html/">consul API reference</a>)</p></li>
<li><p><strong>PATRONI_CONSUL_CHECKS</strong>: (optional) list of Consul health checks used for the session. By default an empty list is used.</p></li>
<li><p><strong>PATRONI_CONSUL_REGISTER_SERVICE</strong>: (optional) whether or not to register a service with the name defined by the scope parameter and the tag master, primary, replica, or standby-leader depending on the node’s role. Defaults to <strong>false</strong></p></li>
<li><p><strong>PATRONI_CONSUL_SERVICE_TAGS</strong>: (optional) additional static tags to add to the Consul service apart from the role (<code class="docutils literal notranslate"><span class="pre">primary</span></code>/<code class="docutils literal notranslate"><span class="pre">replica</span></code>/<code class="docutils literal notranslate"><span class="pre">standby-leader</span></code>). By default an empty list is used.</p></li>
<li><p><strong>PATRONI_CONSUL_SERVICE_CHECK_INTERVAL</strong>: (optional) how often to perform health check against registered url</p></li>
<li><p><strong>PATRONI_CONSUL_SERVICE_CHECK_TLS_SERVER_NAME</strong>: (optional) override SNI host when connecting via TLS, see also <a class="reference external" href="https://www.consul.io/api-docs/agent/check#tlsservername">consul agent check API reference</a>.</p></li>
</ul>
</section>
<section id="etcd">
<h2>Etcd<a class="headerlink" href="#etcd" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_ETCD_PROXY</strong>: proxy url for the etcd. If you are connecting to the etcd using proxy, use this parameter instead of <strong>PATRONI_ETCD_URL</strong></p></li>
<li><p><strong>PATRONI_ETCD_URL</strong>: url for the etcd, in format: http(s)://(username:password&#64;)host:port</p></li>
<li><p><strong>PATRONI_ETCD_HOSTS</strong>: list of etcd endpoints in format ‘host1:port1’,’host2:port2’,etc…</p></li>
<li><p><strong>PATRONI_ETCD_USE_PROXIES</strong>: If this parameter is set to true, Patroni will consider <strong>hosts</strong> as a list of proxies and will not perform a topology discovery of etcd cluster but stick to a fixed list of <strong>hosts</strong>.</p></li>
<li><p><strong>PATRONI_ETCD_PROTOCOL</strong>: http or https, if not specified http is used. If the <strong>url</strong> or <strong>proxy</strong> is specified - will take protocol from them.</p></li>
<li><p><strong>PATRONI_ETCD_HOST</strong>: the host:port for the etcd endpoint.</p></li>
<li><p><strong>PATRONI_ETCD_SRV</strong>: Domain to search the SRV record(s) for cluster autodiscovery. Patroni will try to query these SRV service names for specified domain (in that order until first success): <code class="docutils literal notranslate"><span class="pre">_etcd-client-ssl</span></code>, <code class="docutils literal notranslate"><span class="pre">_etcd-client</span></code>, <code class="docutils literal notranslate"><span class="pre">_etcd-ssl</span></code>, <code class="docutils literal notranslate"><span class="pre">_etcd</span></code>, <code class="docutils literal notranslate"><span class="pre">_etcd-server-ssl</span></code>, <code class="docutils literal notranslate"><span class="pre">_etcd-server</span></code>. If SRV records for <code class="docutils literal notranslate"><span class="pre">_etcd-server-ssl</span></code> or <code class="docutils literal notranslate"><span class="pre">_etcd-server</span></code> are retrieved then ETCD peer protocol is used do query ETCD for available members. Otherwise hosts from SRV records will be used.</p></li>
<li><p><strong>PATRONI_ETCD_SRV_SUFFIX</strong>: Configures a suffix to the SRV name that is queried during discovery. Use this flag to differentiate between multiple etcd clusters under the same domain. Works only with conjunction with <strong>PATRONI_ETCD_SRV</strong>. For example, if <code class="docutils literal notranslate"><span class="pre">PATRONI_ETCD_SRV_SUFFIX=foo</span></code> and <code class="docutils literal notranslate"><span class="pre">PATRONI_ETCD_SRV=example.org</span></code> are set, the following DNS SRV query is made:<code class="docutils literal notranslate"><span class="pre">_etcd-client-ssl-foo._tcp.example.com</span></code> (and so on for every possible ETCD SRV service name).</p></li>
<li><p><strong>PATRONI_ETCD_USERNAME</strong>: username for etcd authentication.</p></li>
<li><p><strong>PATRONI_ETCD_PASSWORD</strong>: password for etcd authentication.</p></li>
<li><p><strong>PATRONI_ETCD_CACERT</strong>: The ca certificate. If present it will enable validation.</p></li>
<li><p><strong>PATRONI_ETCD_CERT</strong>: File with the client certificate.</p></li>
<li><p><strong>PATRONI_ETCD_KEY</strong>: File with the client key. Can be empty if the key is part of certificate.</p></li>
</ul>
</section>
<section id="etcdv3">
<h2>Etcdv3<a class="headerlink" href="#etcdv3" title="Link to this heading"></a></h2>
<p>Environment names for Etcdv3 are similar as for Etcd, you just need to use <code class="docutils literal notranslate"><span class="pre">ETCD3</span></code> instead of <code class="docutils literal notranslate"><span class="pre">ETCD</span></code> in the variable name. Example: <code class="docutils literal notranslate"><span class="pre">PATRONI_ETCD3_HOST</span></code>, <code class="docutils literal notranslate"><span class="pre">PATRONI_ETCD3_CACERT</span></code>, and so on.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Keys created with protocol version 2 are not visible with protocol version 3 and the other way around, therefore it is not possible to switch from Etcd to Etcdv3 just by updating Patroni configuration. In addition, Patroni uses Etcd’s gRPC-gateway (proxy) to communicate with the V3 API, which means that TLS common name authentication is not possible.</p>
</div>
</section>
<section id="zookeeper">
<h2>ZooKeeper<a class="headerlink" href="#zookeeper" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_ZOOKEEPER_HOSTS</strong>: Comma separated list of ZooKeeper cluster members: “‘host1:port1’,’host2:port2’,’etc…’”. It is important to quote every single entity!</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_USE_SSL</strong>: (optional) Whether SSL is used or not. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>. If set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, all SSL specific parameters are ignored.</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_CACERT</strong>: (optional) The CA certificate. If present it will enable validation.</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_CERT</strong>: (optional) File with the client certificate.</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_KEY</strong>: (optional) File with the client key.</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_KEY_PASSWORD</strong>: (optional) The client key password.</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_VERIFY</strong>: (optional) Whether to verify certificate or not. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_SET_ACLS</strong>: (optional) If set, configures Kazoo to apply a default ACL to each ZNode that it creates. ACLs can use either the <cite>x509</cite> schema (default) or other supported ZooKeeper schemes such as <cite>digest</cite>. They should be specified as a dictionary where the key is the full principal (optionally prefixed with the scheme) and the value is a list of permissions. Permissions may be one or more of <code class="docutils literal notranslate"><span class="pre">CREATE</span></code>, <code class="docutils literal notranslate"><span class="pre">READ</span></code>, <code class="docutils literal notranslate"><span class="pre">WRITE</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, <code class="docutils literal notranslate"><span class="pre">ADMIN</span></code>, or <code class="docutils literal notranslate"><span class="pre">ALL</span></code>. For example, <code class="docutils literal notranslate"><span class="pre">set_acls:</span> <span class="pre">{CN=principal1:</span> <span class="pre">[CREATE,</span> <span class="pre">READ],</span> <span class="pre">digest:principal2:+pjROuBuuwNNSujKyH8dGcEnFPQ=:</span> <span class="pre">[ALL]}</span></code>.</p></li>
<li><p><strong>PATRONI_ZOOKEEPER_AUTH_DATA</strong>: (optional) Authentication credentials to use for the connection. Should be a dictionary in the form that <cite>scheme</cite> is the key and <cite>credential</cite> is the value. Defaults to empty dictionary.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is required to install <code class="docutils literal notranslate"><span class="pre">kazoo&gt;=2.6.0</span></code> to support SSL.</p>
</div>
</section>
<section id="exhibitor">
<h2>Exhibitor<a class="headerlink" href="#exhibitor" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_EXHIBITOR_HOSTS</strong>: initial list of Exhibitor (ZooKeeper) nodes in format: ‘host1,host2,etc…’. This list updates automatically whenever the Exhibitor (ZooKeeper) cluster topology changes.</p></li>
<li><p><strong>PATRONI_EXHIBITOR_PORT</strong>: Exhibitor port.</p></li>
</ul>
</section>
<section id="kubernetes">
<span id="kubernetes-environment"></span><h2>Kubernetes<a class="headerlink" href="#kubernetes" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_KUBERNETES_BYPASS_API_SERVICE</strong>: (optional) When communicating with the Kubernetes API, Patroni is usually relying on the <cite>kubernetes</cite> service, the address of which is exposed in the pods via the <cite>KUBERNETES_SERVICE_HOST</cite> environment variable. If <cite>PATRONI_KUBERNETES_BYPASS_API_SERVICE</cite> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, Patroni will resolve the list of API nodes behind the service and connect directly to them.</p></li>
<li><p><strong>PATRONI_KUBERNETES_NAMESPACE</strong>: (optional) Kubernetes namespace where the Patroni pod is running. Default value is <cite>default</cite>.</p></li>
<li><p><strong>PATRONI_KUBERNETES_LABELS</strong>: Labels in format <code class="docutils literal notranslate"><span class="pre">{label1:</span> <span class="pre">value1,</span> <span class="pre">label2:</span> <span class="pre">value2}</span></code>. These labels will be used to find existing objects (Pods and either Endpoints or ConfigMaps) associated with the current cluster. Also Patroni will set them on every object (Endpoint or ConfigMap) it creates.</p></li>
<li><p><strong>PATRONI_KUBERNETES_SCOPE_LABEL</strong>: (optional) name of the label containing cluster name. Default value is <cite>cluster-name</cite>.</p></li>
<li><p><strong>PATRONI_KUBERNETES_BOOTSTRAP_LABELS</strong>: (optional) Labels in format <code class="docutils literal notranslate"><span class="pre">{label1:</span> <span class="pre">value1,</span> <span class="pre">label2:</span> <span class="pre">value2}</span></code>. These labels will be assigned to a Patroni pod when its state is either <code class="docutils literal notranslate"><span class="pre">initializing</span> <span class="pre">new</span> <span class="pre">cluster</span></code>, <code class="docutils literal notranslate"><span class="pre">running</span> <span class="pre">custom</span> <span class="pre">bootstrap</span> <span class="pre">script</span></code>, <code class="docutils literal notranslate"><span class="pre">starting</span> <span class="pre">after</span> <span class="pre">custom</span> <span class="pre">bootstrap</span></code> or <code class="docutils literal notranslate"><span class="pre">creating</span> <span class="pre">replica</span></code>.</p></li>
<li><p><strong>PATRONI_KUBERNETES_ROLE_LABEL</strong>: (optional) name of the label containing role (<cite>primary</cite>, <cite>replica</cite> or other custom value). Patroni will set this label on the pod it runs in. Default value is <code class="docutils literal notranslate"><span class="pre">role</span></code>.</p></li>
<li><p><strong>PATRONI_KUBERNETES_LEADER_LABEL_VALUE</strong>: (optional) value of the pod label when Postgres role is <cite>primary</cite>. Default value is <cite>primary</cite>.</p></li>
<li><p><strong>PATRONI_KUBERNETES_FOLLOWER_LABEL_VALUE</strong>: (optional) value of the pod label when Postgres role is <cite>replica</cite>. Default value is <cite>replica</cite>.</p></li>
<li><p><strong>PATRONI_KUBERNETES_STANDBY_LEADER_LABEL_VALUE</strong>: (optional) value of the pod label when Postgres role is <code class="docutils literal notranslate"><span class="pre">standby_leader</span></code>. Default value is <code class="docutils literal notranslate"><span class="pre">primary</span></code>.</p></li>
<li><p><strong>PATRONI_KUBERNETES_TMP_ROLE_LABEL</strong>: (optional) name of the temporary label containing role (<cite>primary</cite> or <cite>replica</cite>). Value of this label will always use the default of corresponding role. Set only when necessary.</p></li>
<li><p><strong>PATRONI_KUBERNETES_USE_ENDPOINTS</strong>: (optional) if set to true, Patroni will use Endpoints instead of ConfigMaps to run leader elections and keep cluster state.</p></li>
<li><p><strong>PATRONI_KUBERNETES_POD_IP</strong>: (optional) IP address of the pod Patroni is running in. This value is required when <cite>PATRONI_KUBERNETES_USE_ENDPOINTS</cite> is enabled and is used to populate the leader endpoint subsets when the pod’s PostgreSQL is promoted.</p></li>
<li><p><strong>PATRONI_KUBERNETES_PORTS</strong>: (optional) if the Service object has the name for the port, the same name must appear in the Endpoint object, otherwise service won’t work. For example, if your service is defined as <code class="docutils literal notranslate"><span class="pre">{Kind:</span> <span class="pre">Service,</span> <span class="pre">spec:</span> <span class="pre">{ports:</span> <span class="pre">[{name:</span> <span class="pre">postgresql,</span> <span class="pre">port:</span> <span class="pre">5432,</span> <span class="pre">targetPort:</span> <span class="pre">5432}]}}</span></code>, then you have to set <code class="docutils literal notranslate"><span class="pre">PATRONI_KUBERNETES_PORTS='[{&quot;name&quot;:</span> <span class="pre">&quot;postgresql&quot;,</span> <span class="pre">&quot;port&quot;:</span> <span class="pre">5432}]'</span></code> and Patroni will use it for updating subsets of the leader Endpoint. This parameter is used only if <cite>PATRONI_KUBERNETES_USE_ENDPOINTS</cite> is set.</p></li>
<li><p><strong>PATRONI_KUBERNETES_CACERT</strong>: (optional) Specifies the file with the CA_BUNDLE file with certificates of trusted CAs to use while verifying Kubernetes API SSL certs. If not provided, patroni will use the value provided by the ServiceAccount secret.</p></li>
<li><p><strong>PATRONI_RETRIABLE_HTTP_CODES</strong>: (optional) list of HTTP status codes from K8s API to retry on. By default Patroni is retrying on <code class="docutils literal notranslate"><span class="pre">500</span></code>, <code class="docutils literal notranslate"><span class="pre">503</span></code>, and <code class="docutils literal notranslate"><span class="pre">504</span></code>, or if K8s API response has <code class="docutils literal notranslate"><span class="pre">retry-after</span></code> HTTP header.</p></li>
</ul>
</section>
<section id="raft-deprecated">
<h2>Raft (deprecated)<a class="headerlink" href="#raft-deprecated" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_RAFT_SELF_ADDR</strong>: <code class="docutils literal notranslate"><span class="pre">ip:port</span></code> to listen on for Raft connections. The <code class="docutils literal notranslate"><span class="pre">self_addr</span></code> must be accessible from other nodes of the cluster. If not set, the node will not participate in consensus.</p></li>
<li><p><strong>PATRONI_RAFT_BIND_ADDR</strong>: (optional) <code class="docutils literal notranslate"><span class="pre">ip:port</span></code> to listen on for Raft connections. If not specified the <code class="docutils literal notranslate"><span class="pre">self_addr</span></code> will be used.</p></li>
<li><p><strong>PATRONI_RAFT_PARTNER_ADDRS</strong>: list of other Patroni nodes in the cluster in format <code class="docutils literal notranslate"><span class="pre">&quot;'ip1:port1','ip2:port2'&quot;</span></code>. It is important to quote every single entity!</p></li>
<li><p><strong>PATRONI_RAFT_DATA_DIR</strong>: directory where to store Raft log and snapshot. If not specified the current working directory is used.</p></li>
<li><p><strong>PATRONI_RAFT_PASSWORD</strong>: (optional) Encrypt Raft traffic with a specified password, requires <code class="docutils literal notranslate"><span class="pre">cryptography</span></code> python module.</p></li>
</ul>
</section>
<section id="postgresql">
<h2>PostgreSQL<a class="headerlink" href="#postgresql" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_POSTGRESQL_LISTEN</strong>: IP address + port that Postgres listens to. Multiple comma-separated addresses are permitted, as long as the port component is appended after to the last one with a colon, i.e. <code class="docutils literal notranslate"><span class="pre">listen:</span> <span class="pre">127.0.0.1,127.0.0.2:5432</span></code>. Patroni will use the first address from this list to establish local connections to the PostgreSQL node.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_CONNECT_ADDRESS</strong>: IP address + port through which Postgres is accessible from other nodes and applications.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_PROXY_ADDRESS</strong>: IP address + port through which a connection pool (e.g. pgbouncer) running next to Postgres is accessible. The value is written to the member key in DCS as <code class="docutils literal notranslate"><span class="pre">proxy_url</span></code> and could be used/useful for service discovery.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_DATA_DIR</strong>: The location of the Postgres data directory, either existing or to be initialized by Patroni.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_CONFIG_DIR</strong>: The location of the Postgres configuration directory, defaults to the data directory. Must be writable by Patroni.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_DIR</strong>: Path to PostgreSQL binaries. (pg_ctl, initdb, pg_controldata, pg_basebackup, postgres, pg_isready, pg_rewind) The  default value is an empty string meaning that PATH environment variable will be used to find the executables.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_PG_CTL</strong>: (optional) Custom name for <code class="docutils literal notranslate"><span class="pre">pg_ctl</span></code> binary.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_INITDB</strong>: (optional) Custom name for <code class="docutils literal notranslate"><span class="pre">initdb</span></code> binary.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_PG_CONTROLDATA</strong>: (optional) Custom name for <code class="docutils literal notranslate"><span class="pre">pg_controldata</span></code> binary.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_PG_BASEBACKUP</strong>: (optional) Custom name for <code class="docutils literal notranslate"><span class="pre">pg_basebackup</span></code> binary.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_POSTGRES</strong>: (optional) Custom name for <code class="docutils literal notranslate"><span class="pre">postgres</span></code> binary.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_IS_READY</strong>: (optional) Custom name for <code class="docutils literal notranslate"><span class="pre">pg_isready</span></code> binary.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_BIN_PG_REWIND</strong>: (optional) Custom name for <code class="docutils literal notranslate"><span class="pre">pg_rewind</span></code> binary.</p></li>
<li><p><strong>PATRONI_POSTGRESQL_PGPASS</strong>: path to the <a class="reference external" href="https://www.postgresql.org/docs/current/static/libpq-pgpass.html">.pgpass</a> password file. Patroni creates this file before executing pg_basebackup and under some other circumstances. The location must be writable by Patroni.</p></li>
<li><p><strong>PATRONI_REPLICATION_USERNAME</strong>: replication username; the user will be created during initialization. Replicas will use this user to access the replication source via streaming replication</p></li>
<li><p><strong>PATRONI_REPLICATION_PASSWORD</strong>: replication password; the user will be created during initialization.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLMODE</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLMODE">sslmode</a> connection parameter, which allows a client to specify the type of TLS negotiation mode with the server. For more information on how each mode works, please visit the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-ssl.html#LIBPQ-SSL-SSLMODE-STATEMENTS">PostgreSQL documentation</a>. The default mode is <code class="docutils literal notranslate"><span class="pre">prefer</span></code>.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLKEY</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLKEY">sslkey</a> connection parameter, which specifies the location of the secret key used with the client’s certificate.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLPASSWORD</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLPASSWORD">sslpassword</a> connection parameter, which specifies the password for the secret key specified in <code class="docutils literal notranslate"><span class="pre">PATRONI_REPLICATION_SSLKEY</span></code>.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLCERT</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCERT">sslcert</a> connection parameter, which specifies the location of the client certificate.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLROOTCERT</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLROOTCERT">sslrootcert</a> connection parameter, which specifies the location of a file containing one or more certificate authorities (CA) certificates that the client will use to verify a server’s certificate.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLCRL</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCRL">sslcrl</a> connection parameter, which specifies the location of a file containing a certificate revocation list. A client will reject connecting to any server that has a certificate present in this list.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLCRLDIR</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCRLDIR">sslcrldir</a> connection parameter, which specifies the location of a directory with files containing a certificate revocation list. A client will reject connecting to any server that has a certificate present in this list.</p></li>
<li><p><strong>PATRONI_REPLICATION_SSLNEGOTIATION</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLNEGOTIATION">sslnegotiation</a> connection parameter, which controls how SSL encryption is negotiated with the server, if SSL is used.</p></li>
<li><p><strong>PATRONI_REPLICATION_GSSENCMODE</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-GSSENCMODE">gssencmode</a> connection parameter, which determines whether or with what priority a secure GSS TCP/IP connection will be negotiated with the server</p></li>
<li><p><strong>PATRONI_REPLICATION_CHANNEL_BINDING</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-CHANNEL-BINDING">channel_binding</a> connection parameter, which controls the client’s use of channel binding.</p></li>
<li><p><strong>PATRONI_SUPERUSER_USERNAME</strong>: name for the superuser, set during initialization (initdb) and later used by Patroni to connect to the postgres. Also this user is used by pg_rewind.</p></li>
<li><p><strong>PATRONI_SUPERUSER_PASSWORD</strong>: password for the superuser, set during initialization (initdb).</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLMODE</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLMODE">sslmode</a> connection parameter, which allows a client to specify the type of TLS negotiation mode with the server. For more information on how each mode works, please visit the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-ssl.html#LIBPQ-SSL-SSLMODE-STATEMENTS">PostgreSQL documentation</a>. The default mode is <code class="docutils literal notranslate"><span class="pre">prefer</span></code>.</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLKEY</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLKEY">sslkey</a> connection parameter, which specifies the location of the secret key used with the client’s certificate.</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLPASSWORD</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLPASSWORD">sslpassword</a> connection parameter, which specifies the password for the secret key specified in <code class="docutils literal notranslate"><span class="pre">PATRONI_SUPERUSER_SSLKEY</span></code>.</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLCERT</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCERT">sslcert</a> connection parameter, which specifies the location of the client certificate.</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLROOTCERT</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLROOTCERT">sslrootcert</a> connection parameter, which specifies the location of a file containing one or more certificate authorities (CA) certificates that the client will use to verify a server’s certificate.</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLCRL</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCRL">sslcrl</a> connection parameter, which specifies the location of a file containing a certificate revocation list. A client will reject connecting to any server that has a certificate present in this list.</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLCRLDIR</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCRLDIR">sslcrldir</a> connection parameter, which specifies the location of a directory with files containing a certificate revocation list. A client will reject connecting to any server that has a certificate present in this list.</p></li>
<li><p><strong>PATRONI_SUPERUSER_SSLNEGOTIATION</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLNEGOTIATION">sslnegotiation</a> connection parameter, which controls how SSL encryption is negotiated with the server, if SSL is used.</p></li>
<li><p><strong>PATRONI_SUPERUSER_GSSENCMODE</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-GSSENCMODE">gssencmode</a> connection parameter, which determines whether or with what priority a secure GSS TCP/IP connection will be negotiated with the server</p></li>
<li><p><strong>PATRONI_SUPERUSER_CHANNEL_BINDING</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-CHANNEL-BINDING">channel_binding</a> connection parameter, which controls the client’s use of channel binding.</p></li>
<li><p><strong>PATRONI_REWIND_USERNAME</strong>: (optional) name for the user for <code class="docutils literal notranslate"><span class="pre">pg_rewind</span></code>; the user will be created during initialization of postgres 11+ and all necessary <a class="reference external" href="https://www.postgresql.org/docs/11/app-pgrewind.html#id-1.9.5.8.8">permissions</a> will be granted.</p></li>
<li><p><strong>PATRONI_REWIND_PASSWORD</strong>: (optional) password for the user for <code class="docutils literal notranslate"><span class="pre">pg_rewind</span></code>; the user will be created during initialization.</p></li>
<li><p><strong>PATRONI_REWIND_SSLMODE</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLMODE">sslmode</a> connection parameter, which allows a client to specify the type of TLS negotiation mode with the server. For more information on how each mode works, please visit the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-ssl.html#LIBPQ-SSL-SSLMODE-STATEMENTS">PostgreSQL documentation</a>. The default mode is <code class="docutils literal notranslate"><span class="pre">prefer</span></code>.</p></li>
<li><p><strong>PATRONI_REWIND_SSLKEY</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLKEY">sslkey</a> connection parameter, which specifies the location of the secret key used with the client’s certificate.</p></li>
<li><p><strong>PATRONI_REWIND_SSLPASSWORD</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLPASSWORD">sslpassword</a> connection parameter, which specifies the password for the secret key specified in <code class="docutils literal notranslate"><span class="pre">PATRONI_REWIND_SSLKEY</span></code>.</p></li>
<li><p><strong>PATRONI_REWIND_SSLCERT</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCERT">sslcert</a> connection parameter, which specifies the location of the client certificate.</p></li>
<li><p><strong>PATRONI_REWIND_SSLROOTCERT</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLROOTCERT">sslrootcert</a> connection parameter, which specifies the location of a file containing one or more certificate authorities (CA) certificates that the client will use to verify a server’s certificate.</p></li>
<li><p><strong>PATRONI_REWIND_SSLCRL</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCRL">sslcrl</a> connection parameter, which specifies the location of a file containing a certificate revocation list. A client will reject connecting to any server that has a certificate present in this list.</p></li>
<li><p><strong>PATRONI_REWIND_SSLCRLDIR</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLCRLDIR">sslcrldir</a> connection parameter, which specifies the location of a directory with files containing a certificate revocation list. A client will reject connecting to any server that has a certificate present in this list.</p></li>
<li><p><strong>PATRONI_REWIND_SSLNEGOTIATION</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-SSLNEGOTIATION">sslnegotiation</a> connection parameter, which controls how SSL encryption is negotiated with the server, if SSL is used.</p></li>
<li><p><strong>PATRONI_REWIND_GSSENCMODE</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-GSSENCMODE">gssencmode</a> connection parameter, which determines whether or with what priority a secure GSS TCP/IP connection will be negotiated with the server</p></li>
<li><p><strong>PATRONI_REWIND_CHANNEL_BINDING</strong>: (optional) maps to the <a class="reference external" href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-CHANNEL-BINDING">channel_binding</a> connection parameter, which controls the client’s use of channel binding.</p></li>
</ul>
</section>
<section id="rest-api">
<h2>REST API<a class="headerlink" href="#rest-api" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONI_RESTAPI_CONNECT_ADDRESS</strong>: IP address and port to access the REST API.</p></li>
<li><p><strong>PATRONI_RESTAPI_LISTEN</strong>: IP address and port that Patroni will listen to, to provide health-check information for HAProxy.</p></li>
<li><p><strong>PATRONI_RESTAPI_USERNAME</strong>: Basic-auth username to protect unsafe REST API endpoints.</p></li>
<li><p><strong>PATRONI_RESTAPI_PASSWORD</strong>: Basic-auth password to protect unsafe REST API endpoints.</p></li>
<li><p><strong>PATRONI_RESTAPI_CERTFILE</strong>: Specifies the file with the certificate in the PEM format. If the certfile is not specified or is left empty, the API server will work without SSL.</p></li>
<li><p><strong>PATRONI_RESTAPI_KEYFILE</strong>: Specifies the file with the secret key in the PEM format.</p></li>
<li><p><strong>PATRONI_RESTAPI_KEYFILE_PASSWORD</strong>: Specifies a password for decrypting the keyfile.</p></li>
<li><p><strong>PATRONI_RESTAPI_CAFILE</strong>: Specifies the file with the CA_BUNDLE with certificates of trusted CAs to use while verifying client certs.</p></li>
<li><p><strong>PATRONI_RESTAPI_CIPHERS</strong>: (optional) Specifies the permitted cipher suites (e.g. “ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:!SSLv1:!SSLv2:!SSLv3:!TLSv1:!TLSv1.1”)</p></li>
<li><p><strong>PATRONI_RESTAPI_VERIFY_CLIENT</strong>: <code class="docutils literal notranslate"><span class="pre">none</span></code> (default), <code class="docutils literal notranslate"><span class="pre">optional</span></code> or <code class="docutils literal notranslate"><span class="pre">required</span></code>. When <code class="docutils literal notranslate"><span class="pre">none</span></code> REST API will not check client certificates. When <code class="docutils literal notranslate"><span class="pre">required</span></code> client certificates are required for all REST API calls. When <code class="docutils literal notranslate"><span class="pre">optional</span></code> client certificates are required for all unsafe REST API endpoints. When <code class="docutils literal notranslate"><span class="pre">required</span></code> is used, then client authentication succeeds, if the certificate signature verification succeeds. For <code class="docutils literal notranslate"><span class="pre">optional</span></code> the client cert will only be checked for <code class="docutils literal notranslate"><span class="pre">PUT</span></code>, <code class="docutils literal notranslate"><span class="pre">POST</span></code>, <code class="docutils literal notranslate"><span class="pre">PATCH</span></code>, and <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> requests.</p></li>
<li><p><strong>PATRONI_RESTAPI_ALLOWLIST</strong>: (optional): Specifies the set of hosts that are allowed to call unsafe REST API endpoints. The single element could be a host name, an IP address or a network address using CIDR notation. By default <code class="docutils literal notranslate"><span class="pre">allow</span> <span class="pre">all</span></code> is used. In case if <code class="docutils literal notranslate"><span class="pre">allowlist</span></code> or <code class="docutils literal notranslate"><span class="pre">allowlist_include_members</span></code> are set, anything that is not included is rejected.</p></li>
<li><p><strong>PATRONI_RESTAPI_ALLOWLIST_INCLUDE_MEMBERS</strong>: (optional): If set to <code class="docutils literal notranslate"><span class="pre">true</span></code> it allows accessing unsafe REST API endpoints from other cluster members registered in DCS (IP address or hostname is taken from the members <code class="docutils literal notranslate"><span class="pre">api_url</span></code>). Be careful, it might happen that OS will use a different IP for outgoing connections.</p></li>
<li><p><strong>PATRONI_RESTAPI_HTTP_EXTRA_HEADERS</strong>: (optional) HTTP headers let the REST API server pass additional information with an HTTP response.</p></li>
<li><p><strong>PATRONI_RESTAPI_HTTPS_EXTRA_HEADERS</strong>: (optional) HTTPS headers let the REST API server pass additional information with an HTTP response when TLS is enabled. This will also pass additional information set in <code class="docutils literal notranslate"><span class="pre">http_extra_headers</span></code>.</p></li>
<li><p><strong>PATRONI_RESTAPI_REQUEST_QUEUE_SIZE</strong>: (optional): Sets request queue size for TCP socket used by Patroni REST API.  Once the queue is full, further requests get a “Connection denied” error. The default value is 5.</p></li>
<li><p><strong>PATRONI_RESTAPI_SERVER_TOKENS</strong>: (optional) Configures the value of the <code class="docutils literal notranslate"><span class="pre">Server</span></code> HTTP header.  <code class="docutils literal notranslate"><span class="pre">Original</span></code> (default) will expose the original behaviour and display the BaseHTTP and Python versions, e.g. <code class="docutils literal notranslate"><span class="pre">BaseHTTP/0.6</span> <span class="pre">Python/3.12.3</span></code>. <code class="docutils literal notranslate"><span class="pre">Minimal</span></code>: The header will contain only the Patroni version, e.g. <code class="docutils literal notranslate"><span class="pre">Patroni/4.0.0</span></code>. <code class="docutils literal notranslate"><span class="pre">ProductOnly</span></code>: The header will contain only the product name, e.g. <code class="docutils literal notranslate"><span class="pre">Patroni</span></code>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">PATRONI_RESTAPI_CONNECT_ADDRESS</span></code> must be accessible from all nodes of a given Patroni cluster. Internally Patroni is using it during the leader race to find nodes with minimal replication lag.</p></li>
<li><p>If you enabled client certificates validation (<code class="docutils literal notranslate"><span class="pre">PATRONI_RESTAPI_VERIFY_CLIENT</span></code> is set to <code class="docutils literal notranslate"><span class="pre">required</span></code>), you also <strong>must</strong> provide <strong>valid client certificates</strong> in the <code class="docutils literal notranslate"><span class="pre">PATRONI_CTL_CERTFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">PATRONI_CTL_KEYFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">PATRONI_CTL_KEYFILE_PASSWORD</span></code>. If not provided, Patroni will not work correctly.</p></li>
</ul>
</div>
</section>
<section id="ctl">
<h2>CTL<a class="headerlink" href="#ctl" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PATRONICTL_CONFIG_FILE</strong>: (optional) location of the configuration file.</p></li>
<li><p><strong>PATRONI_CTL_USERNAME</strong>: (optional) Basic-auth username for accessing protected REST API endpoints. If not provided <a class="reference internal" href="patronictl.html#patronictl"><span class="std std-ref">patronictl</span></a> will use the value provided for REST API “username” parameter.</p></li>
<li><p><strong>PATRONI_CTL_PASSWORD</strong>: (optional) Basic-auth password for accessing protected REST API endpoints. If not provided <a class="reference internal" href="patronictl.html#patronictl"><span class="std std-ref">patronictl</span></a> will use the value provided for REST API “password” parameter.</p></li>
<li><p><strong>PATRONI_CTL_INSECURE</strong>: (optional) Allow connections to REST API without verifying SSL certs.</p></li>
<li><p><strong>PATRONI_CTL_CACERT</strong>: (optional) Specifies the file with the CA_BUNDLE file or directory with certificates of trusted CAs to use while verifying REST API SSL certs. If not provided <a class="reference internal" href="patronictl.html#patronictl"><span class="std std-ref">patronictl</span></a> will use the value provided for REST API “cafile” parameter.</p></li>
<li><p><strong>PATRONI_CTL_CERTFILE</strong>: (optional) Specifies the file with the client certificate in the PEM format.</p></li>
<li><p><strong>PATRONI_CTL_KEYFILE</strong>: (optional) Specifies the file with the client secret key in the PEM format.</p></li>
<li><p><strong>PATRONI_CTL_KEYFILE_PASSWORD</strong>: (optional) Specifies a password for decrypting the client keyfile.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="yaml_configuration.html" class="btn btn-neutral float-left" title="YAML Configuration Settings" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rest_api.html" class="btn btn-neutral float-right" title="Patroni REST API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Compose, Zalando SE, Patroni Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>